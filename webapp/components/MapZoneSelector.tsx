"use client";
import { MouseEvent, useState } from "react";
import { Button } from "./ui/button";
import { TooltipContent, TooltipProvider, TooltipTrigger } from "./ui/tooltip";
import { Tooltip } from "@radix-ui/react-tooltip";
import { useMap } from "react-map-gl/maplibre";

const ZONE_NOZONE = 0;
const ZONE_METROPOLE = 1;
const ZONE_GUADELOUPE = 2;
const ZONE_MARTINIQUE = 3;
const ZONE_MAYOTTE = 4;
const ZONE_LAREUNION = 5;
const ZONE_GUYANE = 6;

type ZoneConfig = {
  center: [number, number];
  zoom: number;
};

export const ZONE_CONFIGS: { [key: number]: ZoneConfig } = {
  [ZONE_METROPOLE]: {
    center: [2.5, 46.2],
    zoom: 5,
  },
  [ZONE_GUADELOUPE]: {
    center: [-61.5, 16.2],
    zoom: 9,
  },
  [ZONE_MARTINIQUE]: {
    center: [-61, 14.7],
    zoom: 9,
  },
  [ZONE_MAYOTTE]: {
    center: [45, -12.75],
    zoom: 9,
  },
  [ZONE_LAREUNION]: {
    center: [55.5, -21.2],
    zoom: 8,
  },
  [ZONE_GUYANE]: {
    center: [-52.7, 4.3],
    zoom: 6,
  },
};

export default function MapZoneSelector() {
  const { map } = useMap();
  const handleClick = (e: MouseEvent<HTMLButtonElement>) => {
    const numZone: number = parseInt(
      e.currentTarget.getAttribute("value") || "0",
    );
    map?.flyTo({
      center: ZONE_CONFIGS[numZone].center,
      zoom: ZONE_CONFIGS[numZone].zoom,
    });
    setSelectedZone(numZone);
  };
  const [selectedZone, setSelectedZone] = useState<number>(ZONE_NOZONE);

  const DROMS = [
    {
      id: ZONE_METROPOLE,
      tooltip: "Métropole",
      svg: (
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <g fill={selectedZone === ZONE_METROPOLE ? "white" : "custom-drom"}>
            <path d="m10.1278.496343-.67057 2.006887-1.80826.8761-.20649.98329h-1.80925l-.2586-.77286-.93019-.09833.82695 2.47296-2.11898.35988-.98328-.77286-2.16913.91937.774828.51524-.517208.92724 2.53196.30875 1.39528 1.2881-.30974.77289 1.96657 1.2871-.51917 5.1013-.7237 1.3402.41298.5664 2.6883.8761.98328-.6185 1.75612 1.1347h1.705v-1.236l1.4465-1.1288 3.9272.8761 1.9125-2.2675-1.0816-.412-.4651-1.8544.7237-.3088-.7749-.9833.5172-.3087-.3097-.9833-.9312-.1495 1.1367-2.26643 1.1888-.35988v-1.60177l.5693-1.75221-1.8603-.51524-1.0817-.72173h-1.0413l-.6725-.56736-.3609-.67158h-.9833l-.0511-.51524-1.3953-1.1298h-.5683l-.4651-1.08161z" />
          </g>
        </svg>
      ),
    },
    {
      id: ZONE_GUADELOUPE,
      tooltip: "Guadeloupe",
      svg: (
        <svg viewBox="0 0 23.714 18.577" xmlns="http://www.w3.org/2000/svg">
          <g fill={selectedZone === ZONE_GUADELOUPE ? "white" : "custom-drom"}>
            <path d="m9.586.712a2.242 2.242 0 0 1 -.343.537 4.293 4.293 0 0 1 -.77.873c-.327.27-.71.263-.652.595s.439.777.507 1.244.204.424.147 1.067a5.302 5.302 0 0 1 -.383 1.44c-.197.616-.145.793-.616 1.057s-.837.422-.95.295a1.067 1.067 0 0 0 -.799-.484c-.488-.033-.12.245-1.19-.154s-1.74-.487-1.993-.672-.458-.57-.863-.412a.907.907 0 0 0 -.588.51 1.706 1.706 0 0 0 -.482 1.01c-.154.75.059.836.103 1.472s-.273.656.019 1.545a16.28 16.28 0 0 0 .797 2.504 13.591 13.591 0 0 1 .77 2c.214.557.413.914.62 1.371a2.801 2.801 0 0 0 .561 1.04c.337.347.823.818.823.818s.676-.248.98-.335.447.44.9-.028a2.575 2.575 0 0 0 .696-.922c.275-.52.588-.51.882-1.238s.588-.982.37-1.607-.17-.426-.398-1.184a9.68 9.68 0 0 1 -.522-1.547 4.308 4.308 0 0 1 -.141-1.472c.067-.476.351-.899.748-.69s.32.58.852.715a5.68 5.68 0 0 0 1.411.38 2.474 2.474 0 0 0 1.19-.35 10.971 10.971 0 0 0 1.82-.729c.697-.45 1.47-.335 2.211-.621s.831-.51 1.63-.506 1.671.084 1.671.084.75.285.903.006.465-.3-.03-.436-.208.015-.981-.131-.839-.078-1.099-.324-.414-.444-.747-.723-.27-.382-1.112-.497-2.926.334-3.149-.358-.384-.511-.348-1.457.246-.925.106-1.353a1.467 1.467 0 0 0 -.406-.814c-.342-.414-.393-.158-.67-.635s-.173-.451-.466-.67-.323-.145-.503-.234a.856.856 0 0 0 -.516.02z" />
            <path d="m15.698 14.557a1.388 1.388 0 0 0 -.706.842c-.172.414-.087.375-.256.783s-.44.597-.129 1.029 1.04 1.087 1.35 1.065.273.264.837-.172 1.06-.612 1.26-1.023.363-.535.162-.914-.25-.322-.53-.699-.121-.533-.646-.75a1.818 1.818 0 0 0 -.804-.2 1.469 1.469 0 0 0 -.538.039z" />
            <path d="m23.136 4.449a3.277 3.277 0 0 0 -1.256.683 2.218 2.218 0 0 0 -.51.72c-.095.26-.435.66.031.454a3.323 3.323 0 0 0 .788-.37c.606-.354.63-.422.9-.592s.48-.015.487-.327.075-.543-.042-.592a.891.891 0 0 0 -.398.024z" />
          </g>
        </svg>
      ),
    },
    {
      id: ZONE_MARTINIQUE,
      tooltip: "Martinique",
      svg: (
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <g fill={selectedZone === ZONE_MARTINIQUE ? "white" : "custom-drom"}>
            <path d="m6.10336.0799164c-.77266-.3594804-1.61208-.5530404-2.46414-.5681974-.33094.012112-.65623.089577-.95711.227934-.30089.138357-.57143.3348713-.79604.578226-.52061.663383-.5682.520605-.61579 1.373391-.08956.36028-.09334.73656-.01102 1.09857.08233.36202.24844.69966.485.98579.61579.71097 1.32677 1.08977 1.46857 1.46954.1219.49561.16969 1.00655.14181 1.51617 0 .47398-.13015 1.37338.31372 1.89496.44388.52158 1.77064 1.3744 2.43403 2.0397.66338.6653.90037 1.0422 1.65797 1.0898.75759.0476.52157.3788 1.04218 0 .5206-.3788.75759-1.1374 1.08977-.711.14439.1377.25069.3104.30879.5014.058.1909.0657.3936.0224.5884-.017.1767.0084.355.0743.5199s.1703.3117.3045.428c.1428.0972.6634.237.474.5682s-.3312.9004-.7586.711c-.42733-.1894-.52057 0-.75854-.3322-.23796-.3322 0-.8528-.56819-.6634-.5682.1894-.4264.237-.94797.6158-.52158.3788-1.04218.5216-1.08978.948-.04759.4264-.09712 1.3268.3788 1.7056.47593.3788.47399 1.2791.94797 1.1839.47398-.0951.23699.1419.7576-.2845.19601-.1996.43329-.3538.69519-.4519.26191-.0982.54212-.1379.82102-.1163.467.0991.9457.1318 1.4219.0971.6007-.0151 1.2017.0008 1.8008.0476.6157 0 .3418-.473.9528-.0971.6109.3758.8945.3788 1.1791.2369.2846-.1418.948-.3787.6634.0476-.2846.4264-.5216.3507-.6634.7674-.1418.4166-.8052 1.1276-.1894 1.554s.8052 1.2792 1.3734.5682c.3184-.3907.6105-.8021.8741-1.2316.4527-.6634.7372-.6634.6897-1.3734-.0476-.71.3418-.2846.0048-1.8454-.1321-.9077-.3654-1.7977-.6954-2.6535-.4468-1.184-.4944-1.5162-1.0626-1.9426s-1.3268-.9946-1.2792-1.37435c.0476-.37977.5682-.80519 0-.99556-.4671-.24043-1.0043-.30754-1.5161-.1894-.4264.1894-.474.7576-.7586.28459s-.5682-.61579 0-.85278c.3922-.17025.7722-.36724 1.1374-.58957.0248-.12959.0202-.26309-.0134-.39067-.0336-.12759-.0954-.24601-.1809-.34653-.2846-.28459-.711-.5682-.5206-.80616s.5313-.1894.9528-.28459c.4216-.09518.4682-.04662.7528-.28458.2845-.23796.9479-.42639.9479-.71 0-.28362 0-.61579-.237-.71098-.4965-.07061-1.0028-.00341-1.4637.19426-.3992.21697-.8126.4068-1.2374.56819-.3788.14278-.3788.52158-.8061.3788-.3605-.10041-.6668-.33874-.8528-.66338-.2615-.31332-.4992-.64578-.711-.99459-.1894-.3312-.9334-.94797-1.1063-1.23158-.17288-.28361-.69446-.42639-1.26265-.80616-.46987-.28894-.96078-.542181-1.46858-.757597-.18163-.102956-1.17621-.5293466-1.17621-.5293466z" />
          </g>
        </svg>
      ),
    },
    {
      id: ZONE_GUYANE,
      tooltip: "Guyane",
      svg: (
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <g fill={selectedZone === ZONE_GUYANE ? "white" : "custom-drom"}>
            <path d="m8.56843 1.66653c-.37293.01937-.74571-.04095-1.0935-.17695-.67102-.24951-.49108-.42646-1.09351-.573589-.60242-.147126-.73662-.426467-1.08058-.162038-.34395.264427-.31115.220689-.35986.558677-.05726.36637-.20981.71124-.44237 1.00006-.25607.30299-.54742.57431-.86784.8082-.35552.21554-.64451.52517-.83504.89469-.24554.44137-.5567.52885-.50798 1.21975.04871.69089.22963 1.13227.22963 1.44044-.04537.26875-.03419.54401.03281.8082.11432.36781.34395 1.13227.40956 1.38179.17561.47295.40052.92611.67102 1.35194.19935.2937.41821.5737.6551.838.19882.1621.63821.6025.65511.7953.0169.1929.13122.6611-.0169.838-.18101.2574-.38969.494-.6223.7059-.32706.2793-.54079.3827-.52389.6471.04515.336.05614.6757.03281 1.014-.04871.3529.08151.7346-.24554 1.1611-.32706.4264-.47518 1.0438-.85194 1.2923s-.37676.162-.67102.4116c-.29425.2495-.6382-.1323-.50798.2644.13023.3966.17993.4414.47518.5736.40063.2122.81668.394 1.2446.5438.22964.0298.09941.0994.52389 0 .24401-.0394.48106-.1137.70382-.2207.37676-.1621.37676-.0149.86784-.3977.49109-.3827.49109-.6909.86785-.497.37676.1938.47518.5288.80223.5288.29438.0548.59856.0137.86785-.1173.34395-.1908.58949-.4115.78632-.338.19684.0736.68792.1909.65511.3529-.0328.1621-.27834.3828-.11432.3977.28304.0292.56806.0342.85191.0149.344-.0298.7536.2793 1.1134.0586.317-.1721.6138-.3792.8848-.6173.0994-.1322.5726-.4115.7694-.6471.2237-.2784.4007-.5913.5239-.9265.1312-.3529 1.0646-1.352 1.0935-1.69-.0047-.3199.0633-.6367.1988-.9265.1988-.4265 0-.3678.4255-.7495.3575-.4413.6894-.9026.9941-1.3818.2296-.2207.2783-.6174.671-.9852.3638-.3454.6827-.7352.9493-1.1601.2112-.26349.4532-.50078.7208-.70679.0631-.17918.0908-.36893.0815-.55868-.0328-.2356-.1641-.26443-.2784-.55868s.0328-.27934-.1799-.67598-.1799-.07356-.3112-.49705c-.1312-.42348-.1312-.66107-.2624-.73463-.1312-.07357-.1143-.04374-.5239-.14713s-.4583-.07356-.671-.22069c-.2127-.14712-.4911-.29823-.6382-.42646-.1131-.10366-.2172-.21673-.3112-.338-.1799-.20577-.2624-.32308-.3439-.3529-.1166-.03474-.2392-.0449-.3599-.02982l-.3111.02982c-.1336-.06791-.2552-.15724-.3599-.26443-.2622-.24003-.5412-.46096-.835-.66107-.4308-.30647-.8412-.64052-1.2287-1.00006-.1641-.20578-.0994-.52886-.5408-.60242s-.3599.04374-.671-.07356c-.2285-.09391-.4509-.20181-.66607-.32308-.33303-.16204-.19882-.22069-.48015-.22069-.19288.00484-.38476.02949-.5726.07356-.12752-.0017-.25449-.01703-.37875-.04573z" />
          </g>
        </svg>
      ),
    },
    {
      id: ZONE_MAYOTTE,
      tooltip: "Mayotte",
      svg: (
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <g fill={selectedZone === ZONE_MAYOTTE ? "white" : "custom-drom"}>
            <path d="m7.67715 6.83115c-.04925-.24345.09756-.43858-.53615-.48783-.6337-.04924-.68295.09757-1.21909-.24345-.53614-.34101-1.12153-.34101-1.16985-.58538-.04832-.24438.24345-.19513.24345-.58539s-.49805-.2927-.24903-.73127c.24903-.43858-.14123-.4869.44416-.92919.58539-.4423.9487-.2927.98587-.63371.03716-.34101-.15797-.29269.23229-.68295s.19513-.43858.63371-.87716c.43858-.438574.97472-.9756453 1.07228-.536139.09757.439506-.09292.828839 0 1.121529.09292.2927-.09292.43858.48783.73127.58074.2927.53614.09292.68295.68296.14681.59003-.14681.58539.29269.92919.43954.34379.48784.68295 1.02214.43857.5343-.24437.341-.82883 1.0221-.43857.6811.39025.9747.82883 1.6577 1.0221.4114.07482.8184.17253 1.219.2927.4879.19513.6338.04831.7313.38933.0614.12093.0934.25464.0934.39026 0 .13561-.032.26932-.0934.39026-.0612.44073-.2877.84169-.6337 1.12153-.4386.34101-.4386.4395-.8288.78051-.4862.55664-.8221 1.22834-.9757 1.95128.0545.4417.2226.8617.4879 1.2191.2434.3903 1.219.683 1.2674 1.0221.0126.1906-.0316.3806-.127.546-.0954.1655-.2379.2988-.4092.3832-.426.2786-.8046.6237-1.1215 1.0221-.0483.1459.4386.4869.4386.4869-.7313.4878-.8772.341-1.0221.6337-.1287.462-.2102.9358-.2435 1.4142l.1951.5854c.2713.0865.5328.2008.7806.341.1951.1459.3902.5362.1951.683s-.1459.2927-.5854.3893c-.4395.0967-.7313.3903-.8288 0-.0976-.3902-.1952-.7312-.4879-.6337-.2927.0976-.1458.1468-.3893.3903-.2434.2434-.2444.6337-.5854.6829-.341.0493-.58536.2435-.77956 0-.1942-.2434-.24345-.5854-.48783-.6337s-1.12153-.1459-1.12153-.1459c.00331-.2984.05252-.5946.14588-.878.04925-.341.2927-.4869-.19513-.2927-.48782.1942-.48689.4878-.77959.2927-.29269-.1952-1.17077.0492-.43857-.4869.7322-.5362.53614-.1952.73127-.5371s.48689-.4869.24345-.7313c-.1536-.1947-.35539-.3458-.58539-.4386-.39026-.1951-.34101.0001-.53707-.4868s-.2927.1458-.19513-.4879c.09756-.6337 0-.8771.68295-.8288s.92919-.1468.97472.2927-.09757.7313 0 .9292c.09756.1979-.09757.0975.34101.4386.43858.341.43858.4385.92919.3893.49061-.0493.60211.0975.71543-.1951.1134-.2927-.06407-.6923 0-.9292.0642-.237.5204-.1422 0-.7267-.5203-.5844-.32517-.6337-1.00812-1.0221-.68296-.3884-.73128-.1951-1.12153-.7312-.39026-.5362-.87716-.5371-.43858-.8781s.43858.0975.43858-.341c0-.4386.19512.2434 0-.4386-.19513-.68204-.24345-.341-.09292-.97473.15053-.63371.38933-.68295.09292-1.02211-.29642-.33915-.39026-.14588-.34102-.58539.00829-.14729.02473-.29402.04925-.4395z" />
          </g>
        </svg>
      ),
    },
    {
      id: ZONE_LAREUNION,
      tooltip: "La réunion",
      svg: (
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <g fill={selectedZone === ZONE_LAREUNION ? "white" : "custom-drom"}>
            <path d="m5.80153.593899c-.41715.249839-1.04232.834311-1.5827 1.209631-.38758.26703-.82907.44571-1.29329.52342-.29166.06105-.54263-.52342-1.13049-.18879-.58786.33462-.70995.37532-.70995.75065 0 .37532-.08366-.16732 0 .75065.08365.91796.30184 1.13049-.03731 1.45947-.33915.32897-.171836.62629-.714475.75065-.542638.12435-.417153-.41715-.834306.37532-.323767.44516-.458657 1.00016-.375325 1.54426.083657.41716.208011 1.54313.584467 1.7941.446074.45554.799991.99294 1.042318 1.58274.083657.2509.249841 1.0016.249841 1.0016-.103217.2721-.130602.5672-.079234.8537s.179564.5537.370904.7731c.66699.7088.46463 1.1305 1.15084 1.2514.68621.121-.02374.1255.97675.5845.52079.1957 1.01225.4619 1.4606.7913.63565.6226 1.31905 1.1945 2.04394 1.7105.89726.5375 1.86637.9448 2.87825 1.2096 1.16784.2091 1.33514.6263 2.92004.5008.9919.033 1.9845-.0367 2.9619-.208 1.0842-.2917 2.9574-.667 2.9574-.667.1184.0128.2381-.0011.3504-.0406.1124-.0394.2145-.1035.2989-.1874.0844-.084.149-.1858.189-.2979s.0545-.2318.0424-.3502v-1.8359c.2198-.539.3875-1.0977.5008-1.6687.4171-1.5827.6263-1.4187.5844-2.253-.0418-.8343.6783-1.2097 0-1.7941-.3974-.3731-.8172-.72153-1.2571-1.04349-.5714-.30611-1.0806-.71637-1.5013-1.20963-.5008-.66812-.4589-.6523-.9179-1.34868-.459-.69639-.5427-.27923-.7089-1.40521-.1088-.62635-.2765-1.24105-.5008-1.83593-.1254-.54263.2081-.70656-.6263-1.35659-.8343-.65004-.7088-.73143-1.9218-.89875-1.213-.16731-1.7523-.20801-3.0037-.33915-.7888.02068-1.57618-.07765-2.33564-.291665-.45898-.24984-.54264-.876135-1.29329-.542638z" />
          </g>
        </svg>
      ),
    },
  ];

  return (
    <>
      <div className="grid gap-2">
        <div className="w-[48px] grid-cols-1 gap-2 space-y-2">
          {DROMS.map(({ id, tooltip, svg }) => {
            const isSelected = selectedZone === id;
            const buttonClasses = [
              "px-4",
              "py-2",
              "rounded",
              isSelected ? "bg-custom-drom" : "bg-white",
              "w-[48px]",
            ].join(" ");

            return (
              <TooltipProvider key={`DROM_${id}`}>
                <Tooltip>
                  <TooltipTrigger asChild>
                    <Button
                      className={buttonClasses}
                      onClick={handleClick}
                      value={id}
                    >
                      {svg}
                    </Button>
                  </TooltipTrigger>
                  <TooltipContent className="bg-white text-custom-drom">
                    {tooltip}
                  </TooltipContent>
                </Tooltip>
              </TooltipProvider>
            );
          })}
        </div>
      </div>
    </>
  );
}
